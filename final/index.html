<!DOCTYPE html>
<html>
    <head>
       <title>CRP 458 Final</title>
<!--Leaflet css-->  
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"

        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="

        crossorigin=""/>
<!--Leaflet script-->
        <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"

        integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="

        crossorigin="">
        </script>
        
<h1>Des Moines Parks Population Analysis</h1>
        
<!--Homepage-->
        <a style="color: Black" href="https://jwthompson1982.github.io/CRP-458/">Return to Homepage</a>
<!--GeoJsons-->        
        <script src="geojson_directory/Des_Moines_Parks_1mile_Pop.geojson">//parkPop
        </script>
        <script src="geojson_directory/Pop_per_acre.geojson">//density
        </script>
        
<!--Map-->
        <style>
        #map {
            width: 700px;
            height: 600px;   
            background: black;
            }
            .info {
    padding: 6px 8px;
    font: 14px/16px Arial, Helvetica, sans-serif;
    background: white;
    background: rgba(255,255,255,0.8);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    border-radius: 5px;
}
.info h4 {
    margin: 0 0 5px;
    color: #777;
}
        </style>
        
    </head>
        <body>
            <div id="map"></div>
       <link  rel="stylesheet" type="text/css" href="https://jwthompson1982.github.io/CRP-458/final/css.css">     
            <script>
        
                
    var OSM = L.tileLayer('https://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors',
    maxZoom: 18
});
                
    var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
});
                
//Create map
        var map = L.map('map',{
    center: [41.579901, -93.616242],
    zoom: 11,
    layers: [OSM]
    });
                
/*
//control that shows park info on hover -------
var info = L.control(); 
                
info.onAdd = function
 (map) {
this._div
 = L.DomUtil.create('div',
'info');
// create a div with a class "info"
this.update();
return
this._div;
 }; 

// method that we will use to update the control based on feature properties passed
 info.update = function
 (properties) {
this._div.innerHTML
 = '<h4>Population Around Park</h4>'
 + (properties ? '<b>'
 + properties.Name + '</b><br />'
 + properties.SUM_Pop + ' people '
 : 'Hover over a park');
 }; info.addTo(map);                
 //End hover box ----------------------------
*/
  var geojson1 = L.geoJson(parkPop, {
style: style,
onEachFeature: onEachFeature,
}).addTo(map);
                
var geojson2 = L.geoJson(density, {
style: style2,
onEachFeature: onEachFeature2
});               
                
// style function for geojson1             
	function style(feature) {
		return {
			weight: 1,
			opacity: 1,
			color: 'black',
			fillOpacity: 1,
			fillColor: getColor(feature.properties.SUM_Pop)
		};
	}
// style function for geojson2
    function style2(feature2) {
		return {
			weight: 1,
			opacity: 1,
			color: 'black',
			fillOpacity: 1,
			fillColor: getColor2(feature2.properties.Pop_Per_Acre)
		};
	}
                
// color function for geojson1    
function getColor(d) {
  return    d > 27999 ? '#238443' :
            d > 14999 ? '#78c679' :
            d > 8899  ? '#c2e699' :
            d > 296  ? '#ffffcc' :
            '#000';
}
                
// color function for geojson2               
function getColor2(d) {
		return d > 9999 ? '#2e557a' :
				d > 999  ? '#4b7e98' :
				d > 499  ? '#69a8b7' :
                d > 59  ? '#9bc4c1' :
				d > 9  ? '#e6eecf' :
				'#e6eecf';//black = <9
	} 
                
// on each feature function for geojson1     
function onEachFeature(feature, layer) {
		layer.on({
			mouseover: highlightFeature,
			mouseout: resetHighlight,
			click: zoomToFeature,
            
		});
	}
                
// on each feature function for geojson2          
function onEachFeature2(feature, layer) {
		layer.on({
			mouseover: highlightFeature2,
			mouseout: resetHighlight2,
			click: zoomToFeature
		});
	}

	function highlightFeature(e) { //info.update(layer.feature.properties);
		var layer = e.target;
        info.update(layer.feature.properties);
		layer.setStyle({
			weight: 2,
			color: 'black',
			dashArray: '',
			fillOpacity: 0.7,
		});

		if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
			layer.bringToFront();
		}
	}
              
	function resetHighlight(e) { info.update;
		geojson1.resetStyle(e.target);
	}

	function zoomToFeature(e) {
		map.fitBounds(e.target.getBounds());
	}
// hover box-----------------------------                
var info = L.control();

info.onAdd = function (map) {
    this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
    this.update();
    return this._div;
};

// method that we will use to update the control based on feature properties passed
info.update = function (props) {
    this._div.innerHTML = '<h4>Des Moines Parks</h4>' +  (props ?
        '<b>' + props.Name + '</b><br />' + props.SUM_Pop + ' people '
        : 'Hover over a park');
};

info.addTo(map);                
// end hover box--------------------------
	
//Create Legend for litter layer---------------
var legend = L.control({
  position: 'bottomleft'
	  //Possible values are 'topleft', 'topright', 'bottomleft' or 'bottomright'
});

legend.onAdd = function(map) {

  var div = L.DomUtil.create('div', 'info legend'),
    SUM_Pop = [28000, 15000, 8900, 300],
    labels = ['High', ' ', ' ', 'Low'];

	
	//console.log(feature.length);
	
	 div.innerHTML += "<b>Population 1-Mile Around Parks</b><br>";
  // loop through items and generate a label with a colored square for each
  for (var i = 0; i < SUM_Pop.length; i++) {
    div.innerHTML +=
      '<i style="background:' + getColor(SUM_Pop[i] ) + ' "></i> ' +
      SUM_Pop[i] +' '+ labels[i]+'<br>';
  }

  return div;
};
legend.addTo(map);
                
                
//End litter legend--------------------         
//Begin social disatance legend--------                
var legend2 = L.control({
  position: 'bottomright'
	  //Possible values are 'topleft', 'topright', 'bottomleft' or 'bottomright'
});

legend2.onAdd = function(map) {

//new code for legend 2
 var div = L.DomUtil.create('div', 'info legend'), 
    Pop_Per_Acre = [10000, 1000, 500, 60, 10],
    labels2 = ['High', ' ', ' ', ' ', 'Low'];

div.innerHTML += "<b>Population Per Acre of Park</b><br>";

// loop through items and generate a label with a colored square for each  
for (var i = 0; i < Pop_Per_Acre.length; i++) {
    div.innerHTML +=
      '<i style="background:' + getColor2(Pop_Per_Acre[i] ) + ' "></i> ' +
      Pop_Per_Acre[i] +' '+ labels2[i]+'<br>';
  }

  return div;
};   
legend2.addTo(map);
//End Social dist. legend-------------------- 

	var geojson1 = L.geoJson(parkPop, {
		style: style,
		onEachFeature: onEachFeature,
     
        
	   })/*.bindPopup(feature.properties.Name)*/.addTo(map);
                            
        
//End Pop near parks---------------


	function highlightFeature2(e) {
		var layer = e.target;
		layer.setStyle({
			weight: 2,
			color: 'black',
			dashArray: '',
			fillOpacity: 0.7,
		});
      /*  
        function highlightFeature2(e) {                                        geojson1.bindPopup(feature.properties.name)	
		};
*/

		if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
			layer.bringToFront();
		}
	}
              
	function resetHighlight2(e) {
		geojson2.resetStyle(e.target);
	}

	function zoomToFeature2(e) {
		map.fitBounds(e.target.getBounds());
	}

	
	var geojson2 = L.geoJson(density, {
		style: style2,
		onEachFeature: onEachFeature2
        
	   })/*.bindPopup(feature.properties.Name)*/;
                            
        
//End social distancing layer----------------- 
                
//set legend color


/*
function style(feature) {
    return {
        fillColor: getColor(feature.properties.SUM_Pop),
        weight: 1,
        opacity: 1,
        color: 'white',
        dashArray: '2',
        fillOpacity: 0.7
    };
}
*/
 

              
//layer control
		var baseMaps = {
            "Esri World Imagery": Esri_WorldImagery,
            "OpenStreetMap": OSM
        };
        
        var overlayMaps = {
			"Parks more likely to have litter?": geojson1,
            "Parks for Social Distancing":geojson2
        };
        
     L.control.layers(baseMaps, overlayMaps).addTo(map);   
            </script>
            
            
            
            
            
          
<!--Copy from here to end of div to add nav to each page --> 
    <br>
<!--Explination of layers -->
            <h2 style="color: #238443">Population 1-Mile Around Parks</h2>
       <b>The layer seen in green was developed using ARCGIS Online. I downloaded park and census shapefiles from <br><a target="_blank" href="https://www.dsm.city/city_of_des_moines_gis_data/index.php">The City of Des Moines GIS webpage</a>.  I then summarized the population of census blocks within one mile around all<br> of the parks using the tool "Summarize nearby".  This process generated population data that I used to make a<br> choropleth map.  I converted this layer into a GEOJSON file which is visualized above as the "Parks more likely<br> to have more litter?" layer.  I added a question mark to show this is simply a question, and areas with higher <br>populations aren't always going to have more litter issues. Although population near a park is a proper consideration <br>for predicting litter, more factors go into this.   
            </b>
            <br>
            
            <h2 style="color: #2e557a">Population Per Acre of Park</h2>
            <b>The layer seen in blue was also developed using ARCGIS Online, as well as the same data from The City of Des Moines <br> GIS webpage.  I used the first layer I created summarizing population within a mile of each park and simply divided the populations by the acres of the parks.  I named this layer "Parks for social distancing".  Knowing the potential population density of areas around a park is a good
            start, but much more data is needed. Things like daily electronic monitoring of pedestrians and on the ground visuals are great data to have as well.  
            </b>
            
    <br>
    <br>        
    
    <script src="java.js"></script>
<a style="color: " href="javascript:void(0)" class="openbtn" onclick="openNav()">Links to Class Exercises</a> 
    
            
<!--Below is my side navbar to use on each page.  Edit for each page as neccesary-->
   <div id="mySidenav" class="sidenav">
       <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
      
  <ol><br>
    
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise2/">Philmont Scout Ranch</a></li>
      
      <li><a target="_blank" href="https://github.com/jwthompson1982/CRP-458/blob/master/exercise3/IA_CAFOs.geojson">Locations of CAFOs in Iowa</a></li>
      
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise4/#9/41.4989/-93.6840">Cities of Central Iowa with Des Moines Fire Stations</a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/assignment1/index.html">Assignment 1: HTML and Javascript</a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise5/">Getting Started with Leaflet.js</a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise6/">Leaflet.js Vector Layers</a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise7/">Leaflet.js Layer Control - Multiple Layers and Basemaps </a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise8/">Leaflet.js GeoJSON Layers</a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise9/"> Leaflet.js Choropleth Map</a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise10/"> Leaflet Map with Legend </a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise11/"> Leaflet Plugin  </a></li>
      <li><a target="_blank" href="https://jwthompson1982.github.io/CRP-458/exercise12/"> Walnut Woods State Park  </a></li>
        </ol>
  
    </div>  
        </body>
</html>
